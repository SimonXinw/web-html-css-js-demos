<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Video Carousel</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: #000;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .loader {
        color: white;
        font-size: 20px;
        display: none;
      }

      .carousel-container {
        position: relative;
        width: 1000px;
        height: 500px;
        overflow: hidden;
      }

      .carousel-track {
        display: flex;
        height: 100%;
        transition: transform 0.5s ease;
      }

      .video-item {
        position: relative;
        flex: 0 0 20%;
        height: 100%;
        transition: all 0.5s ease;
        transform: scale(0.8);
        filter: brightness(0.5);
      }

      .video-item.active {
        flex: 0 0 40%;
        transform: scale(1);
        filter: brightness(1);
        z-index: 2;
      }

      .video-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
      }

      video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .progress-bar {
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        height: 3px;
        background: rgba(255, 255, 255, 0.3);
        z-index: 1;
      }

      .progress {
        height: 100%;
        background: #ff4757;
        width: 0;
        transition: width 0.1s linear;
      }

      .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
      }

      .nav-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.3);
        border: none;
        color: white;
        padding: 15px;
        cursor: pointer;
        z-index: 3;
      }

      .prev {
        left: 20px;
      }

      .next {
        right: 20px;
      }
    </style>
  </head>
  <body>
    <div class="loader">Loading videos...</div>
    <div class="carousel-container">
      <div class="carousel-track"></div>
      <button class="nav-btn prev">❮</button>
      <button class="nav-btn next">❯</button>
    </div>

    <script>
      const videoUrls = [
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",
        "https://cdn.shopify.com/videos/c/o/v/32920ef6f01c461cb5a5695464e03e40.webm",
        "https://cdn.shopify.com/videos/c/o/v/527df4332f20465282a1e16faef18954.mp4",

      ];

      class VideoCarousel {
        constructor() {
          this.currentIndex = 0;
          this.videoElements = [];
          this.carouselTrack = document.querySelector(".carousel-track");
          this.loader = document.querySelector(".loader");
          this.init();
        }

        async init() {
          this.showLoader();
          await this.createVideoElements();
          this.setupCarousel();
          this.setupEvents();
          this.hideLoader();
          this.setActiveVideo(0);
        }

        showLoader() {
          this.loader.style.display = "block";
        }

        hideLoader() {
          this.loader.style.display = "none";
        }

        createVideoElements() {
          return Promise.all(
            videoUrls.map((url) => {
              return new Promise((resolve) => {
                const videoItem = document.createElement("div");
                videoItem.className = "video-item";

                const videoWrapper = document.createElement("div");
                videoWrapper.className = "video-wrapper";

                const video = document.createElement("video");
                video.src = url;
                video.playsinline = true;

                const progressBar = document.createElement("div");
                progressBar.className = "progress-bar";
                const progress = document.createElement("div");
                progress.className = "progress";
                progressBar.appendChild(progress);

                const overlay = document.createElement("div");
                overlay.className = "overlay";

                video.addEventListener("timeupdate", () => {
                  const percent = (video.currentTime / video.duration) * 100;
                  progress.style.width = `${percent}%`;
                });

                videoWrapper.appendChild(video);
                videoWrapper.appendChild(progressBar);
                videoWrapper.appendChild(overlay);
                videoItem.appendChild(videoWrapper);
                this.carouselTrack.appendChild(videoItem);

                video.addEventListener("loadedmetadata", () => resolve());
                this.videoElements.push(videoItem);
              });
            })
          );
        }

        setupCarousel() {
          this.videoElements.forEach((item, index) => {
            item.style.transform = `translateX(${index * 20}%)`;
          });
        }

        setActiveVideo(index) {
          this.currentIndex = index;
          this.videoElements.forEach((item, i) => {
            const video = item.querySelector("video");
            const overlay = item.querySelector(".overlay");

            item.classList.toggle("active", i === index);
            overlay.style.display = i === index ? "none" : "block";

            if (i === index) {
              video.play();
            } else {
              video.pause();
              video.currentTime = 0;
              item.querySelector(".progress").style.width = "0";
            }
          });

          const offset = -index * 20;
          this.carouselTrack.style.transform = `translateX(${offset}%)`;
        }

        setupEvents() {
          document.querySelector(".prev").addEventListener("click", () => {
            this.currentIndex =
              (this.currentIndex - 1 + videoUrls.length) % videoUrls.length;
            this.setActiveVideo(this.currentIndex);
          });

          document.querySelector(".next").addEventListener("click", () => {
            this.currentIndex = (this.currentIndex + 1) % videoUrls.length;
            this.setActiveVideo(this.currentIndex);
          });
        }
      }

      // 初始化轮播
      new VideoCarousel();
    </script>
  </body>
</html>

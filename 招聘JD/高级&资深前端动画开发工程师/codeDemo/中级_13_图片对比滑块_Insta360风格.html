<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insta360 Style Comparison Slider</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: sans-serif;
        }

        .container {
            position: relative;
            width: 800px;
            height: 450px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            user-select: none; /* 防止拖拽时选中文字 */
        }

        /* 基础层（底层，右侧图） - 通常放"处理后"的效果 */
        .image-base {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://picsum.photos/id/237/800/450') no-repeat center center;
            background-size: cover;
        }
        
        /* 标签 */
        .label {
            position: absolute;
            top: 20px;
            padding: 6px 12px;
            background: rgba(0,0,0,0.6);
            color: white;
            border-radius: 4px;
            font-size: 14px;
            pointer-events: none;
            z-index: 10;
        }
        
        .label-after { right: 20px; }
        .label-before { left: 20px; }

        /* 遮罩层（上层，左侧图） - 通常放"处理前"的效果 */
        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 50%; /* 初始位置 */
            height: 100%;
            overflow: hidden;
            border-right: 2px solid white; /* 分割线 */
            z-index: 2;
        }

        /* 遮罩层里的内容需要反向拉伸以保持位置固定 */
        .image-overlay-inner {
            position: absolute;
            top: 0;
            left: 0;
            width: 800px; /* 必须和容器等宽 */
            height: 450px;
            /* 模糊滤镜模拟防抖关闭效果 */
            background: url('https://picsum.photos/id/237/800/450') no-repeat center center;
            background-size: cover;
            filter: blur(4px) contrast(1.2);
            transform: scale(1.05); /* 稍微放大模拟抖动感 */
        }

        /* 滑块手柄 */
        .handle {
            position: absolute;
            top: 50%;
            left: 50%; /* 初始位置 */
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            cursor: ew-resize;
            z-index: 3;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .handle::after {
            content: '';
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 8px solid #333;
            margin-right: 4px;
        }
        
        .handle::before {
            content: '';
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-left: 8px solid #333;
            margin-left: 4px;
            order: 2;
        }
        
        .instruction {
            position: absolute;
            bottom: -40px;
            width: 100%;
            text-align: center;
            color: #666;
        }

    </style>
</head>
<body>

    <div class="container" id="compareContainer">
        <!-- 底层 (FlowState Stabilization ON) -->
        <div class="image-base">
            <div class="label label-after">FlowState 开启</div>
        </div>

        <!-- 上层 (FlowState Stabilization OFF) -->
        <div class="image-overlay" id="overlay">
            <div class="image-overlay-inner">
                <div class="label label-before">FlowState 关闭</div>
            </div>
        </div>

        <!-- 手柄 -->
        <div class="handle" id="handle"></div>
    </div>
    
    <p class="instruction">拖动滑块对比防抖效果</p>

    <script>
        const container = document.getElementById('compareContainer');
        const overlay = document.getElementById('overlay');
        const handle = document.getElementById('handle');
        
        let isDragging = false;

        function updateSlider(x) {
            const containerRect = container.getBoundingClientRect();
            let percentage = ((x - containerRect.left) / containerRect.width) * 100;

            // 限制范围
            if (percentage < 0) percentage = 0;
            if (percentage > 100) percentage = 100;

            overlay.style.width = percentage + '%';
            handle.style.left = percentage + '%';
        }

        // 鼠标事件
        handle.addEventListener('mousedown', () => isDragging = true);
        window.addEventListener('mouseup', () => isDragging = false);
        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            updateSlider(e.clientX);
        });

        // 触摸事件 (移动端适配)
        handle.addEventListener('touchstart', () => isDragging = true);
        window.addEventListener('touchend', () => isDragging = false);
        window.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            updateSlider(e.touches[0].clientX);
        });
        
        // 点击容器任意位置跳转
        container.addEventListener('click', (e) => {
            updateSlider(e.clientX);
        });
    </script>
</body>
</html>
